function MediumEditor(e,t){"use strict";return this.init(e,t)}!function(e,t){"use strict";function n(){this.$get=["$$sanitizeUri",function(e){return function(t){var n=[];return r(t,c(n,function(t,n){return!/^unsafe/.test(e(t,n))})),n.join("")}}]}function i(e){var n=[],i=c(n,t.noop);return i.chars(e),n.join("")}function o(e){var t,n={},i=e.split(",");for(t=0;t<i.length;t++)n[i[t]]=!0;return n}function r(e,n){function i(e,i,r,s){if(i=t.lowercase(i),A[i])for(;b.last()&&S[b.last()];)o("",b.last());k[i]&&b.last()==i&&o("",i),s=y[i]||!!s,s||b.push(i);var c={};r.replace(p,function(e,t,n,i,o){var r=n||i||o||"";c[t]=a(r)}),n.start&&n.start(i,c,s)}function o(e,i){var o,r=0;if(i=t.lowercase(i))for(r=b.length-1;r>=0&&b[r]!=i;r--);if(r>=0){for(o=b.length-1;o>=r;o--)n.end&&n.end(b[o]);b.length=r}}var r,s,c,b=[],_=e;for(b.last=function(){return b[b.length-1]};e;){if(s=!0,b.last()&&T[b.last()])e=e.replace(new RegExp("(.*)<\\s*\\/\\s*"+b.last()+"[^>]*>","i"),function(e,t){return t=t.replace(m,"$1").replace(g,"$1"),n.chars&&n.chars(a(t)),""}),o("",b.last());else if(0===e.indexOf("<!--")?(r=e.indexOf("--",4),r>=0&&e.lastIndexOf("-->",r)===r&&(n.comment&&n.comment(e.substring(4,r)),e=e.substring(r+3),s=!1)):v.test(e)?(c=e.match(v),c&&(e=e.replace(c[0],""),s=!1)):f.test(e)?(c=e.match(d),c&&(e=e.substring(c[0].length),c[0].replace(d,o),s=!1)):h.test(e)&&(c=e.match(u),c&&(e=e.substring(c[0].length),c[0].replace(u,i),s=!1)),s){r=e.indexOf("<");var w=0>r?e:e.substring(0,r);e=0>r?"":e.substring(r),n.chars&&n.chars(a(w))}if(e==_)throw l("badparse","The sanitizer was unable to parse the following block of html: {0}",e);_=e}o()}function a(e){if(!e)return"";var t=R.exec(e),n=t[1],i=t[3],o=t[2];return o&&(x.innerHTML=o.replace(/</g,"&lt;"),o="textContent"in x?x.textContent:x.innerText),n+o+i}function s(e){return e.replace(/&/g,"&amp;").replace(b,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function c(e,n){var i=!1,o=t.bind(e,e.push);return{start:function(e,r,a){e=t.lowercase(e),!i&&T[e]&&(i=e),i||L[e]!==!0||(o("<"),o(e),t.forEach(r,function(i,r){var a=t.lowercase(r),c="img"===e&&"src"===a||"background"===a;C[a]!==!0||E[a]===!0&&!n(i,c)||(o(" "),o(r),o('="'),o(s(i)),o('"'))}),o(a?"/>":">"))},end:function(e){e=t.lowercase(e),i||L[e]!==!0||(o("</"),o(e),o(">")),e==i&&(i=!1)},chars:function(e){i||o(s(e))}}}var l=t.$$minErr("$sanitize"),u=/^<\s*([\w:-]+)((?:\s+[\w:-]+(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)\s*>/,d=/^<\s*\/\s*([\w:-]+)[^>]*>/,p=/([\w:-]+)(?:\s*=\s*(?:(?:"((?:[^"])*)")|(?:'((?:[^'])*)')|([^>\s]+)))?/g,h=/^</,f=/^<\s*\//,m=/<!--(.*?)-->/g,v=/<!DOCTYPE([^>]*?)>/i,g=/<!\[CDATA\[(.*?)]]>/g,b=/([^\#-~| |!])/g,y=o("area,br,col,hr,img,wbr"),_=o("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),w=o("rp,rt"),k=t.extend({},w,_),A=t.extend({},_,o("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,script,section,table,ul")),S=t.extend({},w,o("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),T=o("script,style"),L=t.extend({},y,A,S,k),E=o("background,cite,href,longdesc,src,usemap"),C=t.extend({},E,o("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,target,title,type,valign,value,vspace,width")),x=document.createElement("pre"),R=/^(\s*)([\s\S]*?)(\s*)$/;t.module("ngSanitize",[]).provider("$sanitize",n),t.module("ngSanitize").filter("linky",["$sanitize",function(e){var n=/((ftp|https?):\/\/|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>]/,o=/^mailto:/;return function(r,a){function s(e){e&&h.push(i(e))}function c(e,n){h.push("<a "),t.isDefined(a)&&(h.push('target="'),h.push(a),h.push('" ')),h.push('href="'),h.push(e),h.push('">'),s(n),h.push("</a>")}if(!r)return r;for(var l,u,d,p=r,h=[];l=p.match(n);)u=l[0],l[2]==l[3]&&(u="mailto:"+u),d=l.index,s(p.substr(0,d)),c(u,l[0].replace(o,"")),p=p.substring(d+l[0].length);return s(p),e(h.join(""))}}])}(window,window.angular),function(){var e=angular.module("angularFileUpload",[]);e.service("$upload",["$http","$timeout",function(e,t){function n(n){n.method=n.method||"POST",n.headers=n.headers||{},n.transformRequest=n.transformRequest||function(t,n){return window.ArrayBuffer&&t instanceof window.ArrayBuffer?t:e.defaults.transformRequest[0](t,n)},window.XMLHttpRequest.__isShim&&(n.headers.__setXHR_=function(){return function(e){n.__XHR=e,n.xhrFn&&n.xhrFn(e),e.upload.addEventListener("progress",function(e){n.progress&&t(function(){n.progress&&n.progress(e)})},!1),e.upload.addEventListener("load",function(e){e.lengthComputable&&t(function(){n.progress&&n.progress(e)})},!1)}});var i=e(n);return i.progress=function(e){return n.progress=e,i},i.abort=function(){return n.__XHR&&t(function(){n.__XHR.abort()}),i},i.xhr=function(e){return n.xhrFn=e,i},i.then=function(e,t){return function(i,o,r){n.progress=r||n.progress;var a=t.apply(e,[i,o,r]);return a.abort=e.abort,a.progress=e.progress,a.xhr=e.xhr,a}}(i,i.then),i}this.upload=function(t){t.headers=t.headers||{},t.headers["Content-Type"]=void 0,t.transformRequest=t.transformRequest||e.defaults.transformRequest;var i=new FormData,o=t.transformRequest,r=t.data;return t.transformRequest=function(e,n){if(r)if(t.formDataAppender)for(var i in r){var a=r[i];t.formDataAppender(e,i,a)}else for(var i in r){var a=r[i];if("function"==typeof o)a=o(a,n);else for(var s=0;s<o.length;s++){var c=o[s];"function"==typeof c&&(a=c(a,n))}e.append(i,a)}if(null!=t.file){var l=t.fileFormDataName||"file";if("[object Array]"===Object.prototype.toString.call(t.file))for(var u="[object String]"===Object.prototype.toString.call(l),s=0;s<t.file.length;s++)e.append(u?l+s:l[s],t.file[s],t.file[s].name);else e.append(l,t.file,t.file.name)}return e},t.data=i,n(t)},this.http=function(e){return n(e)}}]),e.directive("ngFileSelect",["$parse","$timeout",function(e,t){return function(n,i,o){var r=e(o.ngFileSelect);i.bind("change",function(e){var i,o,a=[];if(i=e.target.files,null!=i)for(o=0;o<i.length;o++)a.push(i.item(o));t(function(){r(n,{$files:a,$event:e})})}),i.bind("click",function(){this.value=null})}}]),e.directive("ngFileDropAvailable",["$parse","$timeout",function(e,t){return function(n,i,o){if("draggable"in document.createElement("span")){var r=e(o.ngFileDropAvailable);t(function(){r(n)})}}}]),e.directive("ngFileDrop",["$parse","$timeout",function(e,t){return function(n,i,o){function r(e,t){if(t.isDirectory){var n=t.createReader();c++,n.readEntries(function(t){for(var n=0;n<t.length;n++)r(e,t[n]);c--})}else c++,t.file(function(t){c--,e.push(t)})}if("draggable"in document.createElement("span")){var a=null,s=e(o.ngFileDrop);i[0].addEventListener("dragover",function(e){t.cancel(a),e.stopPropagation(),e.preventDefault(),i.addClass(o.ngFileDragOverClass||"dragover")},!1),i[0].addEventListener("dragleave",function(){a=t(function(){i.removeClass(o.ngFileDragOverClass||"dragover")})},!1);var c=0;i[0].addEventListener("drop",function(e){e.stopPropagation(),e.preventDefault(),i.removeClass(o.ngFileDragOverClass||"dragover");var a=[],l=e.dataTransfer.items;if(l&&l.length>0&&l[0].webkitGetAsEntry)for(var u=0;u<l.length;u++)r(a,l[u].webkitGetAsEntry());else{var d=e.dataTransfer.files;if(null!=d)for(var u=0;u<d.length;u++)a.push(d.item(u))}!function p(i){t(function(){c?p(10):s(n,{$files:a,$event:e})},i||0)}()},!1)}}}])}(),function(){var e=function(){try{var e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(e)return!0}catch(t){if(void 0!=navigator.mimeTypes["application/x-shockwave-flash"])return!0}return!1};if(window.XMLHttpRequest&&(window.FormData?window.XMLHttpRequest=function(e){return function(){var t=new e;return t.setRequestHeader=function(e){return function(n,i){if("__setXHR_"===n){var o=i(t);o instanceof Function&&o(t)}else e.apply(t,arguments)}}(t.setRequestHeader),t}}(window.XMLHttpRequest):(window.XMLHttpRequest=function(t){return function(){var n=new t,i=n.send;return n.__requestHeaders=[],n.open=function(e){return n.upload||(n.upload={}),n.__listeners=[],n.upload.addEventListener=function(e,t){n.__listeners[e]=t},function(t,i,o){e.apply(n,[t,i,o]),n.__url=i}}(n.open),n.getResponseHeader=function(e){return function(t){return n.__fileApiXHR?n.__fileApiXHR.getResponseHeader(t):e.apply(n,[t])}}(n.getResponseHeader),n.getAllResponseHeaders=function(e){return function(){return n.__fileApiXHR?n.__fileApiXHR.getAllResponseHeaders():e.apply(n)}}(n.getAllResponseHeaders),n.abort=function(e){return function(){return n.__fileApiXHR?n.__fileApiXHR.abort():null==e?null:e.apply(n)}}(n.abort),n.setRequestHeader=function(e){return function(t,i){if("__setXHR_"===t){var o=i(n);o instanceof Function&&o(n)}else e.apply(n,arguments)}}(n.setRequestHeader),n.send=function(){if(arguments[0]&&arguments[0].__isShim){var t=arguments[0],o={url:n.__url,complete:function(e,t){!e&&n.__listeners.load&&n.__listeners.load({type:"load",loaded:n.__loaded,total:n.__total,target:n,lengthComputable:!0}),!e&&n.__listeners.loadend&&n.__listeners.loadend({type:"loadend",loaded:n.__loaded,total:n.__total,target:n,lengthComputable:!0}),"abort"===e&&n.__listeners.abort&&n.__listeners.abort({type:"abort",loaded:n.__loaded,total:n.__total,target:n,lengthComputable:!0}),void 0!==t.status&&Object.defineProperty(n,"status",{get:function(){return t.status}}),void 0!==t.statusText&&Object.defineProperty(n,"statusText",{get:function(){return t.statusText}}),Object.defineProperty(n,"readyState",{get:function(){return 4}}),void 0!==t.response&&Object.defineProperty(n,"response",{get:function(){return t.response}}),Object.defineProperty(n,"responseText",{get:function(){return t.responseText}}),n.__fileApiXHR=t,n.onreadystatechange()},progress:function(e){e.target=n,n.__listeners.progress&&n.__listeners.progress(e),n.__total=e.total,n.__loaded=e.loaded},headers:n.__requestHeaders};o.data={},o.files={};for(var r=0;r<t.data.length;r++){var a=t.data[r];null!=a.val&&null!=a.val.name&&null!=a.val.size&&null!=a.val.type?o.files[a.key]=a.val:o.data[a.key]=a.val}setTimeout(function(){if(!e())throw'Adode Flash Player need to be installed. To check ahead use "FileAPI.hasFlash"';n.__fileApiXHR=FileAPI.upload(o)},1)}else i.apply(n,arguments)},n}}(window.XMLHttpRequest),window.XMLHttpRequest.__hasFlash=e()),window.XMLHttpRequest.__isShim=!0),!window.FormData){var t=function(t){if(!e())throw'Adode Flash Player need to be installed. To check ahead use "FileAPI.hasFlash"';if(!t.__isWrapped&&(null!=t.getAttribute("ng-file-select")||null!=t.getAttribute("data-ng-file-select"))){var n=document.createElement("div");n.innerHTML='<div class="js-fileapi-wrapper" style="position:relative; overflow:hidden"></div>',n=n.firstChild;var i=t.parentNode;i.insertBefore(n,t),i.removeChild(t),n.appendChild(t),t.__isWrapped=!0}},n=function(e){return function(t){var n=FileAPI.getFiles(t);t.target||(t.target={}),t.target.files=n,t.target.files.item=function(e){return t.target.files[e]||null},e(t)}},i=function(e,t){return("change"===t.toLowerCase()||"onchange"===t.toLowerCase())&&"file"==e.getAttribute("type")};HTMLInputElement.prototype.addEventListener&&(HTMLInputElement.prototype.addEventListener=function(e){return function(o,r,a,s){i(this,o)?(t(this),e.apply(this,[o,n(r),a,s])):e.apply(this,[o,r,a,s])}}(HTMLInputElement.prototype.addEventListener)),HTMLInputElement.prototype.attachEvent&&(HTMLInputElement.prototype.attachEvent=function(e){return function(o,r){i(this,o)?(t(this),e.apply(this,[o,n(r)])):e.apply(this,[o,r])}}(HTMLInputElement.prototype.attachEvent)),window.FormData=FormData=function(){return{append:function(e,t,n){this.data.push({key:e,val:t,name:n})},data:[],__isShim:!0}},function(){if(window.FileAPI||(window.FileAPI={}),!FileAPI.upload){var t,n,i,o,r,a=document.createElement("script"),s=document.getElementsByTagName("script");if(window.FileAPI.jsUrl)t=window.FileAPI.jsUrl;else if(window.FileAPI.jsPath)n=window.FileAPI.jsPath;else for(i=0;i<s.length;i++)if(r=s[i].src,o=r.indexOf("angular-file-upload-shim.js"),-1==o&&(o=r.indexOf("angular-file-upload-shim.min.js")),o>-1){n=r.substring(0,o);break}null==FileAPI.staticPath&&(FileAPI.staticPath=n),a.setAttribute("src",t||n+"FileAPI.min.js"),document.getElementsByTagName("head")[0].appendChild(a),FileAPI.hasFlash=e()}}()}window.FileReader||(window.FileReader=function(){function e(e,n){var i={type:e,target:t,loaded:n.loaded,total:n.total,error:n.error};return null!=n.result&&(i.target.result=n.result),i}var t=this,n=!1;this.listeners={},this.addEventListener=function(e,n){t.listeners[e]=t.listeners[e]||[],t.listeners[e].push(n)},this.removeEventListener=function(e,n){t.listeners[e]&&t.listeners[e].splice(t.listeners[e].indexOf(n),1)},this.dispatchEvent=function(e){var n=t.listeners[e.type];if(n)for(var i=0;i<n.length;i++)n[i].call(t,e)},this.onabort=this.onerror=this.onload=this.onloadstart=this.onloadend=this.onprogress=null;var i=function(i){if(n||(n=!0,t.onloadstart&&this.onloadstart(e("loadstart",i))),"load"===i.type){t.onloadend&&t.onloadend(e("loadend",i));var o=e("load",i);t.onload&&t.onload(o),t.dispatchEvent(o)}else if("progress"===i.type){var o=e("progress",i);t.onprogress&&t.onprogress(o),t.dispatchEvent(o)}else{var o=e("error",i);t.onerror&&t.onerror(o),t.dispatchEvent(o)}};this.readAsArrayBuffer=function(e){FileAPI.readAsBinaryString(e,i)},this.readAsBinaryString=function(e){FileAPI.readAsBinaryString(e,i)},this.readAsDataURL=function(e){FileAPI.readAsDataURL(e,i)},this.readAsText=function(e){FileAPI.readAsText(e,i)}})}(),angular.module("mnd.multi-transclude",[]).directive("mndMultiTransclude",function(){return{link:function(e,t,n,i,o){if(!o)throw new Error("Illegal use of mndMultiTransculde");o(function(e){var i=angular.element("<div></div>");i.append(e);var o="[name="+n.mndMultiTransclude+"]",r=i[0].querySelector(o);r=angular.element(r),t.replaceWith(r)})}}}),angular.module("mnd.dashboard",["ui.bootstrap","mnd.multi-transclude"]).factory("MndSidebarService",function(){var e=!1;return{getSidebarStatus:function(){return e},toggleSidebarStatus:function(){e=!e}}}).directive("mndSidebar",["MndSidebarService",function(e){return{restrict:"EA",templateUrl:"template/sidebar.html",replace:!0,transclude:!0,scope:{menu:"="},link:function(t){t.isSubmenu=function(e){return"submenu"===e.type},t.toggleSubmenu=function(e){"submenu"===e.type&&(e.open=!e.open)},t.sidebarOpen=e.getSidebarStatus(),t.$on("sidebarStatusChanged",function(){t.sidebarOpen=e.getSidebarStatus()})}}}]).directive("mndToggleSidebar",["MndSidebarService",function(e){return{restrict:"EA",templateUrl:"template/toggle-sidebar.html",replace:!0,scope:{},link:function(t){t.sidebarOpen=e.getSidebarStatus(),t.toggle=function(){e.toggleSidebarStatus(),t.$parent.$broadcast("sidebarStatusChanged")},t.$on("sidebarStatusChanged",function(){t.sidebarOpen=e.getSidebarStatus()})}}}]).directive("mndContent",["MndSidebarService",function(e){return{restrict:"EA",templateUrl:"template/content.html",replace:!0,transclude:!0,scope:{},link:function(t){t.sidebarOpen=e.getSidebarStatus(),t.$on("sidebarStatusChanged",function(){t.sidebarOpen=e.getSidebarStatus()})}}}]),function(e){try{e=angular.module("mnd.dashboard")}catch(t){e=angular.module("mnd.dashboard",[])}e.run(["$templateCache",function(e){e.put("template/content.html",'<div id="mnd-content" ng-class="{\'sidebar-open\': sidebarOpen}" ng-transclude></div>\n')}])}(),function(e){try{e=angular.module("mnd.dashboard")}catch(t){e=angular.module("mnd.dashboard",[])}e.run(["$templateCache",function(e){e.put("template/sidebar.html",'<div id="mnd-sidebar" ng-class="{\'sidebar-open\': sidebarOpen}">\n	<div mnd-multi-transclude="before"></div>\n	<ul class="nav">\n		<li ng-repeat="item in menu.items" ng-click="toggleSubmenu(item)" class="mnd-clickable">\n			<a ng-href="{{item.href}}">\n				<span class="mnd-width-20" ng-if="item.icon">\n					<i class="fa {{item.icon}}"></i>\n				</span>\n				{{item.title}}\n				<span ng-if="isSubmenu(item)" class="pull-right">\n					<i ng-if="!item.open"class="fa fa-angle-left"></i>\n					<i ng-if="item.open"class="fa fa-angle-down"></i>\n				</span>\n			</a>\n			<ul ng-if="isSubmenu(item)" collapse="!item.open" class="nav nav-second-level">\n				<li ng-repeat="subitem in item.items">\n					<a ng-href="{{subitem.href}}">\n						<span class="mnd-width-20"></span>\n						<span class="mnd-width-20" ng-if="subitem.icon">\n							<i class="fa {{subitem.icon}}"></i>\n						</span>\n						{{subitem.title}}\n					</a>\n				</li>\n			</ul>\n		</li>\n	</ul>\n	<div mnd-multi-transclude="after">\n		<div id="mnd-sidebar-footer">\n			<span>\n				MONDORA Srl \n			</span>\n			<br />\n			Milano, Morbegno, Novara, St. Moritz (CH)<br />\n			Via Cornalia 7 <br />\n			20154, Milano <br />\n		</div>\n	</div>\n</div>\n')}])}(),function(e){try{e=angular.module("mnd.dashboard")}catch(t){e=angular.module("mnd.dashboard",[])}e.run(["$templateCache",function(e){e.put("template/toggle-sidebar.html",'<div id="mnd-toggle-sidebar" ng-class="{\'sidebar-open\': sidebarOpen}">\n	<div id="mnd-show-sidebar" ng-click="toggle()">\n		<i class="fa fa-bars" ng-show="!sidebarOpen"></i>\n		<i class="fa fa-times" ng-show="sidebarOpen"></i>\n	</div>\n	<div id="mnd-sidebar-logo">\n		<div class="mnd-mondora-logo">\n			<img src="http://mnd-website.s3.amazonaws.com/img/mondora-logo.png" />\n		</div>\n	</div>\n</div>\n')}])}(),angular.module("mnd.sprinkle",[]).factory("MndWordProcessingService",function(){return function(e){var t={};if(2===e.length)t.left=e[0],t.pivot=e[1],t.right="";else{var n=Math.ceil(e.length/2-1);t.left=e.slice(0,n),t.right=e.slice(n+1),t.pivot=e.slice(n,n+1)}return t.multiplier=/[\,\:\;]$/g.test(e)?1.5:/[\.\!\?]$/g.test(e)?2:1,t}}).factory("MndWordSplittingService",function(){return function(e){var t=e.split(/\s+/);return t}}).directive("mndSprinkle",["$timeout","MndWordSplittingService","MndWordProcessingService",function(e,t,n){return{restrict:"EA",templateUrl:"templates/sprinkle.html",scope:{text:"@",defaultWpm:"@?",autoplay:"@?",autoplayDelay:"@?",progressPercentage:"=?"},link:function(i){i._words=t(i.text),i._wordIndex=0,i._msPerWord=function(){return Math.floor(6e4/i.wpm)},i.increaseSpeed=function(e){var t=i.wpm;t+=e||50,i.wpm=t},i.decreaseSpeed=function(e){var t=i.wpm;t-=e||50,50>t&&(t=50),i.wpm=t},i.wpm=parseInt(i.defaultWpm||"250",10);var o=function(){var t=i._words[i._wordIndex],r=n(t);i.word=r;var a=r.multiplier*i._msPerWord();i._wordIndex++,i.progressPercentage=i._wordIndex/i._words.length*100,i._wordIndex<i._words.length?i._timeout=e(o,a):(i.running=!1,i._wordIndex=0)};if(i.running=!1,i.start=function(){i.running||(i.running=!0,o())},i.pause=function(){i.running&&(e.cancel(i._timeout),i.running=!1)},i.rewind=function(){i._wordIndex=0},i.stop=function(){i.pause(),i.rewind()},"true"===i.autoplay){var r=parseInt(i.autoplayDelay,10),a=isNaN(r)?0:r;e(function(){i.start()},1e3*a)}}}}]),function(e){try{e=angular.module("mnd.sprinkle")}catch(t){e=angular.module("mnd.sprinkle",[])}e.run(["$templateCache",function(e){e.put("templates/sprinkle.html",'<div class="sprinkle-container">\n	<div class="sprinkle-result">\n		\n		<span class="sprinkle-left">\n			&nbsp;\n			{{word.left}}\n		</span>\n		<span class="sprinkle-pivot">\n			<div class="sprinkle-center-line-top"></div>\n			<div class="sprinkle-center-line-center"></div>\n			<div class="sprinkle-center-line-bottom"></div>	\n			{{word.pivot}}\n		</span>\n		<span class="sprinkle-right">\n			{{word.right}}\n		</span>\n	</div>\n	<div class="sprinkle-control-bar">\n		<div class="sprinkle-control-bar-left">\n			<div class="sprinkle-control-btn" ng-click="rewind()"><i class="fa fa-refresh"></i></div>\n			<div class="sprinkle-control-btn" ng-if="running" ng-click="pause()"><i class="fa fa-pause"></i></div>\n			<div class="sprinkle-control-btn" ng-if="!running" ng-click="start()"><i class="fa fa-play"></i></div>\n		</div>\n		<div class="sprinkle-control-bar-right">\n			<div class="sprinkle-control-btn" ng-click="decreaseSpeed()"><i class="fa fa-minus"></i></div>\n			<div class="sprinkle-control-wpm">{{wpm}} wpm </div>\n			<div class="sprinkle-control-btn" ng-click="increaseSpeed()"><i class="fa fa-plus"></i></div>\n		</div>\n	</div>\n<br />\n<br />\n<br />\n\n</div>\n')}])}(),function(e){if("function"==typeof bootstrap)bootstrap("promise",e);else if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeQ=e}else Q=e()}(function(){"use strict";function e(e){return function(){return J.apply(e,arguments)}}function t(e){return e===Object(e)}function n(e){return"[object StopIteration]"===tt(e)||e instanceof W}function i(e,t){if(q&&t.stack&&"object"==typeof e&&null!==e&&e.stack&&-1===e.stack.indexOf(nt)){for(var n=[],i=t;i;i=i.source)i.stack&&n.unshift(i.stack);n.unshift(e.stack);var r=n.join("\n"+nt+"\n");e.stack=o(r)}}function o(e){for(var t=e.split("\n"),n=[],i=0;i<t.length;++i){var o=t[i];s(o)||r(o)||!o||n.push(o)}return n.join("\n")}function r(e){return-1!==e.indexOf("(module.js:")||-1!==e.indexOf("(node.js:")}function a(e){var t=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(e);if(t)return[t[1],Number(t[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(e);if(n)return[n[1],Number(n[2])];var i=/.*@(.+):(\d+)$/.exec(e);return i?[i[1],Number(i[2])]:void 0}function s(e){var t=a(e);if(!t)return!1;var n=t[0],i=t[1];return n===B&&i>=U&&at>=i}function c(){if(q)try{throw new Error}catch(e){var t=e.stack.split("\n"),n=t[0].indexOf("@")>0?t[1]:t[2],i=a(n);if(!i)return;return B=i[0],i[1]}}function l(e,t,n){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t+" is deprecated, use "+n+" instead.",new Error("").stack),e.apply(e,arguments)}}function u(e){return g(e)?e:b(e)?E(e):L(e)}function d(){function e(e){t=e,r.source=e,G(n,function(t,n){z(function(){e.promiseDispatch.apply(e,n)})},void 0),n=void 0,i=void 0}var t,n=[],i=[],o=K(d.prototype),r=K(f.prototype);if(r.promiseDispatch=function(e,o,r){var a=Q(arguments);n?(n.push(a),"when"===o&&r[1]&&i.push(r[1])):z(function(){t.promiseDispatch.apply(t,a)})},r.valueOf=function(){if(n)return r;var e=v(t);return g(e)&&(t=e),e},r.inspect=function(){return t?t.inspect():{state:"pending"}},u.longStackSupport&&q)try{throw new Error}catch(a){r.stack=a.stack.substring(a.stack.indexOf("\n")+1)}return o.promise=r,o.resolve=function(n){t||e(u(n))},o.fulfill=function(n){t||e(L(n))},o.reject=function(n){t||e(T(n))},o.notify=function(e){t||G(i,function(t,n){z(function(){n(e)})},void 0)},o}function p(e){if("function"!=typeof e)throw new TypeError("resolver must be a function.");var t=d();try{e(t.resolve,t.reject,t.notify)}catch(n){t.reject(n)}return t.promise}function h(e){return p(function(t,n){for(var i=0,o=e.length;o>i;i++)u(e[i]).then(t,n)})}function f(e,t,n){void 0===t&&(t=function(e){return T(new Error("Promise does not support operation: "+e))}),void 0===n&&(n=function(){return{state:"unknown"}});var i=K(f.prototype);if(i.promiseDispatch=function(n,o,r){var a;try{a=e[o]?e[o].apply(i,r):t.call(i,o,r)}catch(s){a=T(s)}n&&n(a)},i.inspect=n,n){var o=n();"rejected"===o.state&&(i.exception=o.reason),i.valueOf=function(){var e=n();return"pending"===e.state||"rejected"===e.state?i:e.value}}return i}function m(e,t,n,i){return u(e).then(t,n,i)}function v(e){if(g(e)){var t=e.inspect();if("fulfilled"===t.state)return t.value}return e}function g(e){return t(e)&&"function"==typeof e.promiseDispatch&&"function"==typeof e.inspect}function b(e){return t(e)&&"function"==typeof e.then}function y(e){return g(e)&&"pending"===e.inspect().state}function _(e){return!g(e)||"fulfilled"===e.inspect().state}function w(e){return g(e)&&"rejected"===e.inspect().state}function k(){it.length=0,ot.length=0,rt||(rt=!0)}function A(e,t){rt&&(ot.push(e),it.push(t&&"undefined"!=typeof t.stack?t.stack:"(no stack) "+t))}function S(e){if(rt){var t=Y(ot,e);-1!==t&&(ot.splice(t,1),it.splice(t,1))}}function T(e){var t=f({when:function(t){return t&&S(this),t?t(e):this}},function(){return this},function(){return{state:"rejected",reason:e}});return A(t,e),t}function L(e){return f({when:function(){return e},get:function(t){return e[t]},set:function(t,n){e[t]=n},"delete":function(t){delete e[t]},post:function(t,n){return null===t||void 0===t?e.apply(void 0,n):e[t].apply(e,n)},apply:function(t,n){return e.apply(t,n)},keys:function(){return et(e)}},void 0,function(){return{state:"fulfilled",value:e}})}function E(e){var t=d();return z(function(){try{e.then(t.resolve,t.reject,t.notify)}catch(n){t.reject(n)}}),t.promise}function C(e){return f({isDef:function(){}},function(t,n){return I(e,t,n)},function(){return u(e).inspect()})}function x(e,t,n){return u(e).spread(t,n)}function R(e){return function(){function t(e,t){var a;if("undefined"==typeof StopIteration){try{a=i[e](t)}catch(s){return T(s)}return a.done?a.value:m(a.value,o,r)}try{a=i[e](t)}catch(s){return n(s)?s.value:T(s)}return m(a,o,r)}var i=e.apply(this,arguments),o=t.bind(t,"next"),r=t.bind(t,"throw");return o()}}function P(e){u.done(u.async(e)())}function N(e){throw new W(e)}function O(e){return function(){return x([this,H(arguments)],function(t,n){return e.apply(t,n)})}}function I(e,t,n){return u(e).dispatch(t,n)}function H(e){return m(e,function(e){var t=0,n=d();return G(e,function(i,o,r){var a;g(o)&&"fulfilled"===(a=o.inspect()).state?e[r]=a.value:(++t,m(o,function(i){e[r]=i,0===--t&&n.resolve(e)},n.reject,function(e){n.notify({index:r,value:e})}))},void 0),0===t&&n.resolve(e),n.promise})}function j(e){return m(e,function(e){return e=V(e,u),m(H(V(e,function(e){return m(e,X,X)})),function(){return e})})}function F(e){return u(e).allSettled()}function D(e,t){return u(e).then(void 0,void 0,t)}function M(e,t){return u(e).nodeify(t)}var q=!1;try{throw new Error}catch($){q=!!$.stack}var B,W,U=c(),X=function(){},z=function(){function e(){for(;t.next;){t=t.next;var n=t.task;t.task=void 0;var o=t.domain;o&&(t.domain=void 0,o.enter());try{n()}catch(a){if(r)throw o&&o.exit(),setTimeout(e,0),o&&o.enter(),a;setTimeout(function(){throw a},0)}o&&o.exit()}i=!1}var t={task:void 0,next:null},n=t,i=!1,o=void 0,r=!1;if(z=function(e){n=n.next={task:e,domain:r&&process.domain,next:null},i||(i=!0,o())},"undefined"!=typeof process&&process.nextTick)r=!0,o=function(){process.nextTick(e)};else if("function"==typeof setImmediate)o="undefined"!=typeof window?setImmediate.bind(window,e):function(){setImmediate(e)};else if("undefined"!=typeof MessageChannel){var a=new MessageChannel;a.port1.onmessage=function(){o=s,a.port1.onmessage=e,e()};var s=function(){a.port2.postMessage(0)};o=function(){setTimeout(e,0),s()}}else o=function(){setTimeout(e,0)};return z}(),J=Function.call,Q=e(Array.prototype.slice),G=e(Array.prototype.reduce||function(e,t){var n=0,i=this.length;if(1===arguments.length)for(;;){if(n in this){t=this[n++];break}if(++n>=i)throw new TypeError}for(;i>n;n++)n in this&&(t=e(t,this[n],n));return t}),Y=e(Array.prototype.indexOf||function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1}),V=e(Array.prototype.map||function(e,t){var n=this,i=[];return G(n,function(o,r,a){i.push(e.call(t,r,a,n))},void 0),i}),K=Object.create||function(e){function t(){}return t.prototype=e,new t},Z=e(Object.prototype.hasOwnProperty),et=Object.keys||function(e){var t=[];for(var n in e)Z(e,n)&&t.push(n);return t},tt=e(Object.prototype.toString);W="undefined"!=typeof ReturnValue?ReturnValue:function(e){this.value=e};var nt="From previous event:";u.resolve=u,u.nextTick=z,u.longStackSupport=!1,u.defer=d,d.prototype.makeNodeResolver=function(){var e=this;return function(t,n){t?e.reject(t):e.resolve(arguments.length>2?Q(arguments,1):n)}},u.Promise=p,u.promise=p,p.race=h,p.all=H,p.reject=T,p.resolve=u,u.passByCopy=function(e){return e},f.prototype.passByCopy=function(){return this},u.join=function(e,t){return u(e).join(t)},f.prototype.join=function(e){return u([this,e]).spread(function(e,t){if(e===t)return e;throw new Error("Can't join: not the same: "+e+" "+t)})},u.race=h,f.prototype.race=function(){return this.then(u.race)},u.makePromise=f,f.prototype.toString=function(){return"[object Promise]"},f.prototype.then=function(e,t,n){function o(t){try{return"function"==typeof e?e(t):t}catch(n){return T(n)}}function r(e){if("function"==typeof t){i(e,s);try{return t(e)}catch(n){return T(n)}}return T(e)}function a(e){return"function"==typeof n?n(e):e}var s=this,c=d(),l=!1;return z(function(){s.promiseDispatch(function(e){l||(l=!0,c.resolve(o(e)))},"when",[function(e){l||(l=!0,c.resolve(r(e)))}])}),s.promiseDispatch(void 0,"when",[void 0,function(e){var t,n=!1;try{t=a(e)}catch(i){if(n=!0,!u.onerror)throw i;u.onerror(i)}n||c.notify(t)}]),c.promise},u.when=m,f.prototype.thenResolve=function(e){return this.then(function(){return e})},u.thenResolve=function(e,t){return u(e).thenResolve(t)},f.prototype.thenReject=function(e){return this.then(function(){throw e})},u.thenReject=function(e,t){return u(e).thenReject(t)},u.nearer=v,u.isPromise=g,u.isPromiseAlike=b,u.isPending=y,f.prototype.isPending=function(){return"pending"===this.inspect().state},u.isFulfilled=_,f.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},u.isRejected=w,f.prototype.isRejected=function(){return"rejected"===this.inspect().state};var it=[],ot=[],rt=!0;u.resetUnhandledRejections=k,u.getUnhandledReasons=function(){return it.slice()},u.stopUnhandledRejectionTracking=function(){k(),rt=!1},k(),u.reject=T,u.fulfill=L,u.master=C,u.spread=x,f.prototype.spread=function(e,t){return this.all().then(function(t){return e.apply(void 0,t)},t)},u.async=R,u.spawn=P,u["return"]=N,u.promised=O,u.dispatch=I,f.prototype.dispatch=function(e,t){var n=this,i=d();return z(function(){n.promiseDispatch(i.resolve,e,t)}),i.promise},u.get=function(e,t){return u(e).dispatch("get",[t])},f.prototype.get=function(e){return this.dispatch("get",[e])},u.set=function(e,t,n){return u(e).dispatch("set",[t,n])},f.prototype.set=function(e,t){return this.dispatch("set",[e,t])},u.del=u["delete"]=function(e,t){return u(e).dispatch("delete",[t])},f.prototype.del=f.prototype["delete"]=function(e){return this.dispatch("delete",[e])},u.mapply=u.post=function(e,t,n){return u(e).dispatch("post",[t,n])},f.prototype.mapply=f.prototype.post=function(e,t){return this.dispatch("post",[e,t])},u.send=u.mcall=u.invoke=function(e,t){return u(e).dispatch("post",[t,Q(arguments,2)])},f.prototype.send=f.prototype.mcall=f.prototype.invoke=function(e){return this.dispatch("post",[e,Q(arguments,1)])},u.fapply=function(e,t){return u(e).dispatch("apply",[void 0,t])},f.prototype.fapply=function(e){return this.dispatch("apply",[void 0,e])},u["try"]=u.fcall=function(e){return u(e).dispatch("apply",[void 0,Q(arguments,1)])},f.prototype.fcall=function(){return this.dispatch("apply",[void 0,Q(arguments)])},u.fbind=function(e){var t=u(e),n=Q(arguments,1);return function(){return t.dispatch("apply",[this,n.concat(Q(arguments))])}},f.prototype.fbind=function(){var e=this,t=Q(arguments);return function(){return e.dispatch("apply",[this,t.concat(Q(arguments))])}},u.keys=function(e){return u(e).dispatch("keys",[])},f.prototype.keys=function(){return this.dispatch("keys",[])},u.all=H,f.prototype.all=function(){return H(this)},u.allResolved=l(j,"allResolved","allSettled"),f.prototype.allResolved=function(){return j(this)},u.allSettled=F,f.prototype.allSettled=function(){return this.then(function(e){return H(V(e,function(e){function t(){return e.inspect()}return e=u(e),e.then(t,t)}))})},u.fail=u["catch"]=function(e,t){return u(e).then(void 0,t)},f.prototype.fail=f.prototype["catch"]=function(e){return this.then(void 0,e)},u.progress=D,f.prototype.progress=function(e){return this.then(void 0,void 0,e)},u.fin=u["finally"]=function(e,t){return u(e)["finally"](t)},f.prototype.fin=f.prototype["finally"]=function(e){return e=u(e),this.then(function(t){return e.fcall().then(function(){return t
})},function(t){return e.fcall().then(function(){throw t})})},u.done=function(e,t,n,i){return u(e).done(t,n,i)},f.prototype.done=function(e,t,n){var o=function(e){z(function(){if(i(e,r),!u.onerror)throw e;u.onerror(e)})},r=e||t||n?this.then(e,t,n):this;"object"==typeof process&&process&&process.domain&&(o=process.domain.bind(o)),r.then(void 0,o)},u.timeout=function(e,t,n){return u(e).timeout(t,n)},f.prototype.timeout=function(e,t){var n=d(),i=setTimeout(function(){n.reject(new Error(t||"Timed out after "+e+" ms"))},e);return this.then(function(e){clearTimeout(i),n.resolve(e)},function(e){clearTimeout(i),n.reject(e)},n.notify),n.promise},u.delay=function(e,t){return void 0===t&&(t=e,e=void 0),u(e).delay(t)},f.prototype.delay=function(e){return this.then(function(t){var n=d();return setTimeout(function(){n.resolve(t)},e),n.promise})},u.nfapply=function(e,t){return u(e).nfapply(t)},f.prototype.nfapply=function(e){var t=d(),n=Q(e);return n.push(t.makeNodeResolver()),this.fapply(n).fail(t.reject),t.promise},u.nfcall=function(e){var t=Q(arguments,1);return u(e).nfapply(t)},f.prototype.nfcall=function(){var e=Q(arguments),t=d();return e.push(t.makeNodeResolver()),this.fapply(e).fail(t.reject),t.promise},u.nfbind=u.denodeify=function(e){var t=Q(arguments,1);return function(){var n=t.concat(Q(arguments)),i=d();return n.push(i.makeNodeResolver()),u(e).fapply(n).fail(i.reject),i.promise}},f.prototype.nfbind=f.prototype.denodeify=function(){var e=Q(arguments);return e.unshift(this),u.denodeify.apply(void 0,e)},u.nbind=function(e,t){var n=Q(arguments,2);return function(){function i(){return e.apply(t,arguments)}var o=n.concat(Q(arguments)),r=d();return o.push(r.makeNodeResolver()),u(i).fapply(o).fail(r.reject),r.promise}},f.prototype.nbind=function(){var e=Q(arguments,0);return e.unshift(this),u.nbind.apply(void 0,e)},u.nmapply=u.npost=function(e,t,n){return u(e).npost(t,n)},f.prototype.nmapply=f.prototype.npost=function(e,t){var n=Q(t||[]),i=d();return n.push(i.makeNodeResolver()),this.dispatch("post",[e,n]).fail(i.reject),i.promise},u.nsend=u.nmcall=u.ninvoke=function(e,t){var n=Q(arguments,2),i=d();return n.push(i.makeNodeResolver()),u(e).dispatch("post",[t,n]).fail(i.reject),i.promise},f.prototype.nsend=f.prototype.nmcall=f.prototype.ninvoke=function(e){var t=Q(arguments,1),n=d();return t.push(n.makeNodeResolver()),this.dispatch("post",[e,t]).fail(n.reject),n.promise},u.nodeify=M,f.prototype.nodeify=function(e){return e?void this.then(function(t){z(function(){e(null,t)})},function(t){z(function(){e(t)})}):this};var at=c();return u}),function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof exports?module.exports=t():e.DDP=t()}(this,function(){"use strict";var e=function(){var e=0;return function(){return(e++).toString()}}(),t='{"server_id":"0"}',n=10,i=500,o=["added","changed","connected","error","failed","nosub","ready","removed","result","updated"],r=function(e){this._endpoint=e.endpoint,this._SocketConstructor=e.SocketConstructor,this._autoreconnect=!e.do_not_autoreconnect,this._debug=e.debug,this._onReadyCallbacks={},this._onResultCallbacks={},this._onUpdatedCallbacks={},this._events={},this._queue=[],this.readyState=-1,this._reconnect_count=0,this._reconnect_incremental_timer=0,e.do_not_autoconnect||this.connect()};return r.prototype.constructor=r,r.prototype.connect=function(){this._socket=new this._SocketConstructor(this._endpoint),this.readyState=0,this._socket.onopen=this._on_socket_open.bind(this),this._socket.onmessage=this._on_socket_message.bind(this),this._socket.onerror=this._on_socket_error.bind(this),this._socket.onclose=this._on_socket_close.bind(this)},r.prototype.method=function(t,n,i,o){var r=e();this._onResultCallbacks[r]=i,this._onUpdatedCallbacks[r]=o,this._send({msg:"method",id:r,method:t,params:n})},r.prototype.sub=function(t,n,i){var o=e();this._onReadyCallbacks[o]=i,this._send({msg:"sub",id:o,name:t,params:n})},r.prototype.unsub=function(e){this._send({msg:"unsub",id:e})},r.prototype.on=function(e,t){this._events[e]=this._events[e]||[],this._events[e].push(t)},r.prototype.off=function(e,t){this._events[e]&&this._events[e].splice(this._events[e].indexOf(t),1)},r.prototype._emit=function(e){if(this._events[e]){var t=arguments,n=this;this._events[e].forEach(function(e){e.apply(n,Array.prototype.slice.call(t,1))})}},r.prototype._send=function(e){if(1!==this.readyState&&"connect"!==e.msg)return void this._queue.push(e);var t;t="undefined"==typeof EJSON?JSON.stringify(e):EJSON.stringify(e),this._socket.send(t)},r.prototype._try_reconnect=function(){this._reconnect_count<n&&setTimeout(this.connect.bind(this),this._reconnect_incremental_timer),this._reconnect_count+=1,this._reconnect_incremental_timer+=i*this._reconnect_count},r.prototype._on_result=function(e){if(this._onResultCallbacks[e.id])this._onResultCallbacks[e.id](e.error,e.result),delete this._onResultCallbacks[e.id],e.error&&delete this._onUpdatedCallbacks[e.id];else if(e.error)throw delete this._onUpdatedCallbacks[e.id],e.error},r.prototype._on_updated=function(e){var t=this;e.methods.forEach(function(e){t._onUpdatedCallbacks[e]&&(t._onUpdatedCallbacks[e](),delete t._onUpdatedCallbacks[e])})},r.prototype._on_nosub=function(e){if(!this._onReadyCallbacks[e.id])throw e.error;this._onReadyCallbacks[e.id](e.error,e.id),delete this._onReadyCallbacks[e.id]},r.prototype._on_ready=function(e){var t=this;e.subs.forEach(function(e){t._onReadyCallbacks[e]&&(t._onReadyCallbacks[e](null,e),delete t._onReadyCallbacks[e])})},r.prototype._on_error=function(e){this._emit("error",e)},r.prototype._on_connected=function(e){this.readyState=1,this._reconnect_count=0,this._reconnect_incremental_timer=0,this._emit("connected",e);for(var t=this._queue.length,n=0;t>n;n++)this._send(this._queue.shift())},r.prototype._on_failed=function(e){this.readyState=4,this._emit("failed",e)},r.prototype._on_added=function(e){this._emit("added",e)},r.prototype._on_removed=function(e){this._emit("removed",e)},r.prototype._on_changed=function(e){this._emit("changed",e)},r.prototype._on_socket_close=function(){this.readyState=4,this._emit("socket_close"),this._autoreconnect&&this._try_reconnect()},r.prototype._on_socket_error=function(e){this.readyState=4,this._emit("socket_error",e),this._autoreconnect&&this._try_reconnect()},r.prototype._on_socket_open=function(){this._send({msg:"connect",version:"pre1",support:["pre1"]})},r.prototype._on_socket_message=function(e){var n;if(this._debug&&console.log(e),e.data!==t){try{if(n="undefined"==typeof EJSON?JSON.parse(e.data):EJSON.parse(e.data),-1===o.indexOf(n.msg))throw new Error}catch(i){return console.warn("Non DDP message received:"),void console.warn(e.data)}this["_on_"+n.msg](n)}},r}),function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof exports?module.exports=t():e.Asteroid=t()}(this,function(){"use strict";function e(e){if("undefined"!=typeof EJSON)return EJSON.clone(e);var t=typeof e;switch(t){case"undefined":case"function":return void 0;case"string":case"number":case"boolean":return e;case"object":return null===e?null:JSON.parse(JSON.stringify(e));default:return}}function t(e){var t="";for(var n in e)t+=n+"="+e[n]+"&";return t=t.slice(0,-1)}function n(){for(var e="",t=0;8>t;t++)e+=Math.floor(65536*(1+Math.random())).toString(16).substring(1);return e}function i(e,t){var n=JSON.stringify(e),i=JSON.stringify(t);return n===i}var o=function(){};o.prototype={constructor:o,_events:{},on:function(e,t){this._events[e]=this._events[e]||[],this._events[e].push(t)},off:function(e,t){this._events[e]&&this._events[e].splice(this._events[e].indexOf(t),1)},_emit:function(e){if(this._events[e]){var t=arguments,n=this;this._events[e].forEach(function(e){e.apply(n,Array.prototype.slice.call(t,1))})}}};var r=function(e){this._host=e.host,this._ddpOptions=e.ddpOptions,this._ddpOptions.do_not_autoconnect=!0,this._do_not_autocreate_collections=e._do_not_autocreate_collections,this.collections={},this.subscriptions={},this._init()};r.prototype=new o,r.prototype.constructor=r,r.prototype._init=function(){var e=this;e.ddp=new DDP(this._ddpOptions),e.ddp.on("connected",function(){e._tryResumeLogin(),e.ddp.sub("meteor.loginServiceConfiguration"),e._emit("connected")}),e.ddp.on("added",function(t){e._onAdded(t)}),e.ddp.on("changed",function(t){e._onChanged(t)}),e.ddp.on("removed",function(t){e._onRemoved(t)}),e.ddp.connect()},r.prototype._onAdded=function(e){var t=["meteor_accounts_loginServiceConfiguration","users"],n=e.collection;if(!this.collections[n]){if(this._do_not_autocreate_collections&&-1===t.indexOf(n))return;this.createCollection(n)}var i=e.fields||{};i._id=e.id,this.collections[n]._remoteToLocalInsert(i)},r.prototype._onRemoved=function(e){this.collections[e.collection]&&this.collections[e.collection]._remoteToLocalRemove(e.id)},r.prototype._onChanged=function(e){this.collections[e.collection]&&(e.fields||(e.fields={}),e.cleared&&e.cleared.forEach(function(t){e.fields[t]=void 0}),this.collections[e.collection]._remoteToLocalUpdate(e.id,e.fields))},r.prototype.subscribe=function(e){if(this.subscriptions[e])return this.subscriptions[e];var t=Q.defer();this.subscriptions[e]=t.promise;var n=Array.prototype.slice.call(arguments,1);return this.ddp.sub(e,n,function(e,n){e?t.reject(e,n):t.resolve(n)}),this.subscriptions[e]},r.prototype.unsubscribe=function(e){this.ddp.unsub(e)},r.prototype.call=function(e){var t=Array.prototype.slice.call(arguments,1);return this.apply(e,t)},r.prototype.apply=function(e,t){var n=Q.defer(),i=Q.defer(),o=function(e,t){e?(n.reject(e),i.reject()):n.resolve(t)},r=function(){i.resolve()};return this.ddp.method(e,t,o,r),{result:n.promise,updated:i.promise}},r.prototype.createCollection=function(e){return this.collections[e]||(this.collections[e]=new a(e,this,l)),this.collections[e]};var a=function(e,t,n){this.name=e,this.asteroid=t,this.db=new n};a.prototype=new o,a.prototype.constructor=a,a.prototype._localToLocalInsert=function(e){var t=this.db.get(e._id);if(t)throw new Error("Item exists");this.db.set(e._id,e),this._emit("insert",e._id)},a.prototype._remoteToLocalInsert=function(e){var t=this.db.get(e._id);i(t,e)||(this.db.set(e._id,e),this._emit("insert",e._id))},a.prototype._restoreInserted=function(e){this.db.del(e),this._emit("restore",e)},a.prototype._localToRemoteInsert=function(e){var t=this,n=Q.defer(),i="/"+t.name+"/insert";return this.asteroid.ddp.method(i,[e],function(i,o){i?(t._restoreInserted(e._id),n.reject(i)):n.resolve(o)}),n.promise},a.prototype.insert=function(e){return e._id||(e._id=n()),this._localToLocalInsert(e,!1),this._localToRemoteInsert(e)};var s="__del__";a.prototype._localToLocalRemove=function(e){var t=this.db.get(e);return t?(this.db.set(e+s,t),this.db.del(e),void this._emit("remove",e)):void console.warn("Item not present.")},a.prototype._remoteToLocalRemove=function(e){var t=this.db.get(e);return t?(this.db.del(e),this.db.del(e+s),void this._emit("remove",e)):void console.warn("Item not present.")},a.prototype._restoreRemoved=function(e){var t=this.db.get(e+s);this.db.set(e,t),this.db.del(e+s),this._emit("restore",e)},a.prototype._localToRemoteRemove=function(e){var t=this,n=Q.defer(),i="/"+t.name+"/remove";return this.asteroid.ddp.method(i,[{_id:e}],function(i,o){i?(t._restoreRemoved(e),n.reject(i)):n.resolve(o)}),n.promise},a.prototype.remove=function(e){return this._localToLocalRemove(e),this._localToRemoteRemove(e)};var c="__upd__";a.prototype._localToLocalUpdate=function(e,t){var n=this.db.get(e);if(!n)throw new Error("Item not present");this.db.set(e+c,n),this.db.set(e,t),this._emit("update",e)},a.prototype._remoteToLocalUpdate=function(e,t){var n=this.db.get(e);if(!n)return void console.warn("Item not present");for(var i in t)n[i]=t[i];this.db.set(e,n),this.db.del(e+c),this._emit("update",e)},a.prototype._restoreUpdated=function(e){var t=this.db.get(e+c);this.db.set(e,t),this.db.del(e+c),this._emit("restore",e)},a.prototype._localToRemoteUpdate=function(e,t){var n=this,i=Q.defer(),o="/"+n.name+"/update",r={_id:e},a={$set:t};return this.asteroid.ddp.method(o,[r,a],function(t,o){t?(n._restoreUpdated(e),i.reject(t)):i.resolve(o)}),i.promise},a.prototype.update=function(e,t){return this._localToLocalUpdate(e,t),this._localToRemoteUpdate(e,t)};var l=function(){this.itemsHash={},this.itemsArray=[]};return l.prototype.constructor=l,l.prototype.set=function(t,n){n=e(n),this.itemsHash[t]=n,this.itemsArray.push(n)},l.prototype.get=function(t){return e(this.itemsHash[t])},l.prototype.find=function(e){var t=function(e,t){return t.split(".").reduce(function(e,t){return e=e[t]},e)},n=Object.keys(e),i=[];return this.itemsArray.forEach(function(o){for(var r=0;r<matchers.length;r++){var a=t(o,n[r]);if(a!==e[n[r]])return}i.push(o)}),i},l.prototype.del=function(e){if(this.itemsHash[e]){var t=this.itemsArray.indexOf(this.itemsHash[e]);this.itemsArray.splice(t,1),delete this.itemsHash[e]}},l.prototype.ls=function(){return e(this.itemsArray)},r.DumbDb=l,r.prototype._getOauthClientId=function(e){var t="meteor_accounts_loginServiceConfiguration",n=this.collections[t].db.itemsArray,i="";return n.forEach(function(t){t.service===e&&("facebook"===e&&(i=t.appId),"google"===e&&(i=t.clientId),"github"===e&&(i=t.clientId),"twitter"===e&&(i=t.consumerKey))}),i},r.prototype._initOauthLogin=function(e,t,n){var i=this;return Q().then(function(){var e=Q.defer(),t=window.open(n,"Login");t.focus&&t.focus();var i=setInterval(function(){(t.closed||void 0===t.closed)&&(clearInterval(i),e.resolve())},100);return e.promise}).then(function(){var e=Q.defer(),n={oauth:{credentialToken:t}};return i.ddp.method("login",[n],function(t,n){t?(delete i.userId,delete i.loggedIn,delete localStorage[i._host+"__login_token__"],e.reject(t),i._emit("loginError",t)):(i.userId=n.id,i.loggedIn=!0,localStorage[i._host+"__login_token__"]=n.token,i._emit("login",n),e.resolve(n.id))}),e.promise})},r.prototype._tryResumeLogin=function(){var e=this,t=localStorage[e._host+"__login_token__"];return t?Q().then(function(){var n=Q.defer(),i={resume:t};return e.ddp.method("login",[i],function(t,i){t?(delete e.userId,delete e.loggedIn,delete localStorage[e._host+"__login_token__"],e._emit("loginError",t),n.reject(t)):(e.userId=i.id,e.loggedIn=!0,localStorage[e._host+"__login_token__"]=i.token,e._emit("login",i),n.resolve(i.id))}),n.promise}):void 0},r.prototype.loginWithFacebook=function(e){var i=n(),o={client_id:this._getOauthClientId("facebook"),redirect_uri:this._host+"/_oauth/facebook?close",state:i,scope:e||"email"},r="https://www.facebook.com/dialog/oauth?"+t(o);return this._initOauthLogin("facebook",i,r)},r.prototype.loginWithGoogle=function(e){var i=n(),o={response_type:"code",client_id:this._getOauthClientId("google"),redirect_uri:this._host+"/_oauth/google?close",state:i,scope:e||"openid email"},r="https://accounts.google.com/o/oauth2/auth?"+t(o);return this._initOauthLogin("google",i,r)},r.prototype.loginWithGithub=function(e){var i=n(),o={client_id:this._getOauthClientId("github"),redirect_uri:this._host+"/_oauth/github?close",state:i,scope:e||"email"},r="https://github.com/login/oauth/authorize?"+t(o);return this._initOauthLogin("github",i,r)},r.prototype.loginWithTwitter=function(){var e=n(),i=this._host+"/_oauth/twitter?close&state="+e,o={requestTokenAndRedirect:encodeURIComponent(i),state:e},r=this._host+"/_oauth/twitter/?"+t(o);return this._initOauthLogin("twitter",e,r)},r.prototype.logout=function(){var e=Q.defer();return self.ddp.method("logout",[],function(t,n){t?(self._emit("logoutError",t),e.reject(t)):(delete self.userId,delete self.loggedIn,delete localStorage[self._host+"__login_token__"],self._emit("logout",n),e.resolve(n))}),e.promise},r}),angular.module("asteroid",[]).factory("$collection",function(e){return function(t){var n={},i=function(e){return JSON.parse(JSON.stringify(e))},o=function(){n.array=i(t.db.itemsArray),n.hash=i(t.db.itemsHash)};return t.on("change",function(){e(o,0)}),o(),n}}),"object"==typeof module&&(module.exports=MediumEditor),function(e,t){"use strict";function n(e,t){var n;if(void 0===e)return t;for(n in t)t.hasOwnProperty(n)&&e.hasOwnProperty(n)===!1&&(e[n]=t[n]);return e}function i(){var t,n,i,o=e.getSelection();if(o.getRangeAt&&o.rangeCount){for(i=[],t=0,n=o.rangeCount;n>t;t+=1)i.push(o.getRangeAt(t));return i}return null}function o(t){var n,i,o=e.getSelection();if(t)for(o.removeAllRanges(),n=0,i=t.length;i>n;n+=1)o.addRange(t[n])}function r(){var e=t.getSelection().anchorNode,n=e&&3===e.nodeType?e.parentNode:e;return n}function a(){var n,i,o,r,a="";if(void 0!==e.getSelection){if(i=e.getSelection(),i.rangeCount){for(r=t.createElement("div"),n=0,o=i.rangeCount;o>n;n+=1)r.appendChild(i.getRangeAt(n).cloneContents());a=r.innerHTML}}else void 0!==t.selection&&"Text"===t.selection.type&&(a=t.selection.createRange().htmlText);return a}function s(e){return!(!e||1!==e.nodeType)}MediumEditor.prototype={defaults:{allowMultiParagraphSelection:!0,anchorInputPlaceholder:"Paste or type a link",anchorPreviewHideDelay:500,buttons:["bold","italic","underline","anchor","header1","header2","quote"],buttonLabels:!1,checkLinkFormat:!1,cleanPastedHTML:!1,delay:0,diffLeft:0,diffTop:-10,disableReturn:!1,disableDoubleReturn:!1,disableToolbar:!1,firstHeader:"h3",forcePlainText:!0,placeholder:"Type your text",secondHeader:"h4",targetBlank:!1,extensions:{}},isIE:"Microsoft Internet Explorer"===navigator.appName||"Netscape"===navigator.appName&&null!==new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(navigator.userAgent),init:function(e,i){return this.elements="string"==typeof e?t.querySelectorAll(e):e,1===this.elements.nodeType&&(this.elements=[this.elements]),0!==this.elements.length?(this.parentElements=["p","h1","h2","h3","h4","h5","h6","blockquote","pre"],this.id=t.querySelectorAll(".medium-editor-toolbar").length+1,this.options=n(i,this.defaults),this.setup()):void 0},setup:function(){this.isActive=!0,this.initElements().bindSelect().bindPaste().setPlaceholders().bindWindowActions()},initElements:function(){var e,t=!1;for(e=0;e<this.elements.length;e+=1)this.elements[e].setAttribute("contentEditable",!0),this.elements[e].getAttribute("data-placeholder")||this.elements[e].setAttribute("data-placeholder",this.options.placeholder),this.elements[e].setAttribute("data-medium-element",!0),this.bindParagraphCreation(e).bindReturn(e).bindTab(e),this.options.disableToolbar||this.elements[e].getAttribute("data-disable-toolbar")||(t=!0);return t&&this.initToolbar().bindButtons().bindAnchorForm().bindAnchorPreview(),this},serialize:function(){var e,t,n={};for(e=0;e<this.elements.length;e+=1)t=""!==this.elements[e].id?this.elements[e].id:"element-"+e,n[t]={value:this.elements[e].innerHTML.trim()};return n},callExtensions:function(e){if(!(arguments.length<1)){var t,n,i=Array.prototype.slice.call(arguments,1);for(n in this.options.extensions)this.options.extensions.hasOwnProperty(n)&&(t=this.options.extensions[n],void 0!==t[e]&&t[e].apply(t,i))}},bindParagraphCreation:function(e){var n=this;return this.elements[e].addEventListener("keyup",function(e){var i,o=r();o&&o.getAttribute("data-medium-element")&&0===o.children.length&&!n.options.disableReturn&&!o.getAttribute("data-disable-return")&&t.execCommand("formatBlock",!1,"p"),13===e.which&&(o=r(),i=o.tagName.toLowerCase(),n.options.disableReturn||this.getAttribute("data-disable-return")||"li"===i||n.isListItemChild(o)||(e.shiftKey||t.execCommand("formatBlock",!1,"p"),"a"===i&&t.execCommand("unlink",!1,null)))}),this},isListItemChild:function(e){for(var t=e.parentNode,n=t.tagName.toLowerCase();-1===this.parentElements.indexOf(n)&&"div"!==n;){if("li"===n)return!0;if(t=t.parentNode,!t||!t.tagName)return!1;n=t.tagName.toLowerCase()}return!1},bindReturn:function(e){var t=this;return this.elements[e].addEventListener("keypress",function(e){if(13===e.which)if(t.options.disableReturn||this.getAttribute("data-disable-return"))e.preventDefault();else if(t.options.disableDoubleReturn||this.getAttribute("data-disable-double-return")){var n=r();n&&"\n"===n.innerText&&e.preventDefault()}}),this},bindTab:function(e){return this.elements[e].addEventListener("keydown",function(e){if(9===e.which){var n=r().tagName.toLowerCase();"pre"===n&&(e.preventDefault(),t.execCommand("insertHtml",null,"    "))}}),this},buttonTemplate:function(e){var t=this.getButtonLabels(this.options.buttonLabels),n={bold:'<button class="medium-editor-action medium-editor-action-bold" data-action="bold" data-element="b">'+t.bold+"</button>",italic:'<button class="medium-editor-action medium-editor-action-italic" data-action="italic" data-element="i">'+t.italic+"</button>",underline:'<button class="medium-editor-action medium-editor-action-underline" data-action="underline" data-element="u">'+t.underline+"</button>",strikethrough:'<button class="medium-editor-action medium-editor-action-strikethrough" data-action="strikethrough" data-element="strike"><strike>A</strike></button>',superscript:'<button class="medium-editor-action medium-editor-action-superscript" data-action="superscript" data-element="sup">'+t.superscript+"</button>",subscript:'<button class="medium-editor-action medium-editor-action-subscript" data-action="subscript" data-element="sub">'+t.subscript+"</button>",anchor:'<button class="medium-editor-action medium-editor-action-anchor" data-action="anchor" data-element="a">'+t.anchor+"</button>",image:'<button class="medium-editor-action medium-editor-action-image" data-action="image" data-element="img">'+t.image+"</button>",header1:'<button class="medium-editor-action medium-editor-action-header1" data-action="append-'+this.options.firstHeader+'" data-element="'+this.options.firstHeader+'">'+t.header1+"</button>",header2:'<button class="medium-editor-action medium-editor-action-header2" data-action="append-'+this.options.secondHeader+'" data-element="'+this.options.secondHeader+'">'+t.header2+"</button>",quote:'<button class="medium-editor-action medium-editor-action-quote" data-action="append-blockquote" data-element="blockquote">'+t.quote+"</button>",orderedlist:'<button class="medium-editor-action medium-editor-action-orderedlist" data-action="insertorderedlist" data-element="ol">'+t.orderedlist+"</button>",unorderedlist:'<button class="medium-editor-action medium-editor-action-unorderedlist" data-action="insertunorderedlist" data-element="ul">'+t.unorderedlist+"</button>",pre:'<button class="medium-editor-action medium-editor-action-pre" data-action="append-pre" data-element="pre">'+t.pre+"</button>",indent:'<button class="medium-editor-action medium-editor-action-indent" data-action="indent" data-element="ul">'+t.indent+"</button>",outdent:'<button class="medium-editor-action medium-editor-action-outdent" data-action="outdent" data-element="ul">'+t.outdent+"</button>"};return n[e]||!1},getButtonLabels:function(e){var t,n,i={bold:"<b>B</b>",italic:"<b><i>I</i></b>",underline:"<b><u>U</u></b>",superscript:"<b>x<sup>1</sup></b>",subscript:"<b>x<sub>1</sub></b>",anchor:"<b>#</b>",image:"<b>image</b>",header1:"<b>H1</b>",header2:"<b>H2</b>",quote:"<b>&ldquo;</b>",orderedlist:"<b>1.</b>",unorderedlist:"<b>&bull;</b>",pre:"<b>0101</b>",indent:"<b>&rarr;</b>",outdent:"<b>&larr;</b>"};if("fontawesome"===e?t={bold:'<i class="fa fa-bold"></i>',italic:'<i class="fa fa-italic"></i>',underline:'<i class="fa fa-underline"></i>',superscript:'<i class="fa fa-superscript"></i>',subscript:'<i class="fa fa-subscript"></i>',anchor:'<i class="fa fa-link"></i>',image:'<i class="fa fa-picture-o"></i>',quote:'<i class="fa fa-quote-right"></i>',orderedlist:'<i class="fa fa-list-ol"></i>',unorderedlist:'<i class="fa fa-list-ul"></i>',pre:'<i class="fa fa-code fa-lg"></i>',indent:'<i class="fa fa-indent"></i>',outdent:'<i class="fa fa-outdent"></i>'}:"object"==typeof e&&(t=e),"object"==typeof t)for(n in t)t.hasOwnProperty(n)&&(i[n]=t[n]);return i},initToolbar:function(){return this.toolbar?this:(this.toolbar=this.createToolbar(),this.keepToolbarAlive=!1,this.anchorForm=this.toolbar.querySelector(".medium-editor-toolbar-form-anchor"),this.anchorInput=this.anchorForm.querySelector("input"),this.toolbarActions=this.toolbar.querySelector(".medium-editor-toolbar-actions"),this.anchorPreview=this.createAnchorPreview(),this)},createToolbar:function(){var e=t.createElement("div");return e.id="medium-editor-toolbar-"+this.id,e.className="medium-editor-toolbar",e.appendChild(this.toolbarButtons()),e.appendChild(this.toolbarFormAnchor()),t.body.appendChild(e),e},toolbarButtons:function(){var e,n,i,o,r=this.options.buttons,a=t.createElement("ul");for(a.id="medium-editor-toolbar-actions",a.className="medium-editor-toolbar-actions clearfix",n=0;n<r.length;n+=1)this.options.extensions.hasOwnProperty(r[n])?(o=this.options.extensions[r[n]],i=void 0!==o.getButton?o.getButton():null):i=this.buttonTemplate(r[n]),i&&(e=t.createElement("li"),s(i)?e.appendChild(i):e.innerHTML=i,a.appendChild(e));return a},toolbarFormAnchor:function(){var e=t.createElement("div"),n=t.createElement("input"),i=t.createElement("a");return i.setAttribute("href","#"),i.innerHTML="&times;",n.setAttribute("type","text"),n.setAttribute("placeholder",this.options.anchorInputPlaceholder),e.className="medium-editor-toolbar-form-anchor",e.id="medium-editor-toolbar-form-anchor",e.appendChild(n),e.appendChild(i),e},bindSelect:function(){var e,n=this,i="";for(this.checkSelectionWrapper=function(e){return e&&n.clickingIntoArchorForm(e)?!1:(clearTimeout(i),void(i=setTimeout(function(){n.checkSelection()},n.options.delay)))},t.documentElement.addEventListener("mouseup",this.checkSelectionWrapper),e=0;e<this.elements.length;e+=1)this.elements[e].addEventListener("keyup",this.checkSelectionWrapper),this.elements[e].addEventListener("blur",this.checkSelectionWrapper);return this},checkSelection:function(){var t,n;return this.keepToolbarAlive===!0||this.options.disableToolbar||(t=e.getSelection(),""===t.toString().trim()||this.options.allowMultiParagraphSelection===!1&&this.hasMultiParagraphs()?this.hideToolbarActions():(n=this.getSelectionElement(),!n||n.getAttribute("data-disable-toolbar")?this.hideToolbarActions():this.checkSelectionElement(t,n))),this},clickingIntoArchorForm:function(e){var t=this;return e.type&&"blur"===e.type.toLowerCase()&&e.relatedTarget&&e.relatedTarget===t.anchorInput?!0:!1},hasMultiParagraphs:function(){var e=a().replace(/<[\S]+><\/[\S]+>/gim,""),t=e.match(/<(p|h[0-6]|blockquote)>([\s\S]*?)<\/(p|h[0-6]|blockquote)>/g);return t?t.length:0},checkSelectionElement:function(e,t){var n;for(this.selection=e,this.selectionRange=this.selection.getRangeAt(0),n=0;n<this.elements.length;n+=1)if(this.elements[n]===t)return void this.setToolbarButtonStates().setToolbarPosition().showToolbarActions();this.hideToolbarActions()},getSelectionElement:function(){var t,n,i,o,r=e.getSelection(),a=function(e){var t=e;try{for(;!t.getAttribute("data-medium-element");)t=t.parentNode}catch(n){return!1}return t};try{t=r.getRangeAt(0),n=t.commonAncestorContainer,i=n.parentNode,o=n.getAttribute("data-medium-element")?n:a(i)}catch(s){o=a(i)}return o},setToolbarPosition:function(){var t=50,n=e.getSelection(),i=n.getRangeAt(0),o=i.getBoundingClientRect(),r=this.options.diffLeft-this.toolbar.offsetWidth/2,a=(o.left+o.right)/2,s=this.toolbar.offsetWidth/2;return o.top<t?(this.toolbar.classList.add("medium-toolbar-arrow-over"),this.toolbar.classList.remove("medium-toolbar-arrow-under"),this.toolbar.style.top=t+o.bottom-this.options.diffTop+e.pageYOffset-this.toolbar.offsetHeight+"px"):(this.toolbar.classList.add("medium-toolbar-arrow-under"),this.toolbar.classList.remove("medium-toolbar-arrow-over"),this.toolbar.style.top=o.top+this.options.diffTop+e.pageYOffset-this.toolbar.offsetHeight+"px"),this.toolbar.style.left=s>a?r+s+"px":e.innerWidth-a<s?e.innerWidth+r-s+"px":r+a+"px",this.hideAnchorPreview(),this},setToolbarButtonStates:function(){var e,t=this.toolbarActions.querySelectorAll("button");for(e=0;e<t.length;e+=1)t[e].classList.remove("medium-editor-button-active");return this.checkActiveButtons(),this},checkActiveButtons:function(){var e=Array.prototype.slice.call(this.elements),t=this.selection.anchorNode;for(t.tagName||(t=this.selection.anchorNode.parentNode);void 0!==t.tagName&&-1===this.parentElements.indexOf(t.tagName.toLowerCase)&&(this.activateButton(t.tagName.toLowerCase()),this.callExtensions("checkState",t),-1===e.indexOf(t));)t=t.parentNode},activateButton:function(e){var t=this.toolbar.querySelector('[data-element="'+e+'"]');null!==t&&-1===t.className.indexOf("medium-editor-button-active")&&(t.className+=" medium-editor-button-active")},bindButtons:function(){var e,t=this.toolbar.querySelectorAll("button"),n=this,i=function(e){e.preventDefault(),e.stopPropagation(),void 0===n.selection&&n.checkSelection(),this.className.indexOf("medium-editor-button-active")>-1?this.classList.remove("medium-editor-button-active"):this.className+=" medium-editor-button-active",this.hasAttribute("data-action")&&n.execAction(this.getAttribute("data-action"),e)};for(e=0;e<t.length;e+=1)t[e].addEventListener("click",i);return this.setFirstAndLastItems(t),this},setFirstAndLastItems:function(e){return e.length>0&&(e[0].className+=" medium-editor-button-first",e[e.length-1].className+=" medium-editor-button-last"),this},execAction:function(n,i){n.indexOf("append-")>-1?(this.execFormatBlock(n.replace("append-","")),this.setToolbarPosition(),this.setToolbarButtonStates()):"anchor"===n?this.triggerAnchorAction(i):"image"===n?t.execCommand("insertImage",!1,e.getSelection()):(t.execCommand(n,!1,null),this.setToolbarPosition())},triggerAnchorAction:function(){return"a"===this.selection.anchorNode.parentNode.tagName.toLowerCase()?t.execCommand("unlink",!1,null):"block"===this.anchorForm.style.display?this.showToolbarActions():this.showAnchorForm(),this},execFormatBlock:function(e){var n=this.getSelectionData(this.selection.anchorNode);if("blockquote"===e&&n.el&&"blockquote"===n.el.parentNode.tagName.toLowerCase())return t.execCommand("outdent",!1,null);if(n.tagName===e&&(e="p"),this.isIE){if("blockquote"===e)return t.execCommand("indent",!1,e);e="<"+e+">"}return t.execCommand("formatBlock",!1,e)},getSelectionData:function(e){var t;for(e&&e.tagName&&(t=e.tagName.toLowerCase());e&&-1===this.parentElements.indexOf(t);)e=e.parentNode,e&&e.tagName&&(t=e.tagName.toLowerCase());return{el:e,tagName:t}},getFirstChild:function(e){for(var t=e.firstChild;null!==t&&1!==t.nodeType;)t=t.nextSibling;return t},hideToolbarActions:function(){this.keepToolbarAlive=!1,void 0!==this.toolbar&&this.toolbar.classList.remove("medium-editor-toolbar-active")},showToolbarActions:function(){var e,t=this;this.anchorForm.style.display="none",this.toolbarActions.style.display="block",this.keepToolbarAlive=!1,clearTimeout(e),e=setTimeout(function(){t.toolbar&&!t.toolbar.classList.contains("medium-editor-toolbar-active")&&t.toolbar.classList.add("medium-editor-toolbar-active")},100)},showAnchorForm:function(e){this.toolbarActions.style.display="none",this.savedSelection=i(),this.anchorForm.style.display="block",this.keepToolbarAlive=!0,this.anchorInput.focus(),this.anchorInput.value=e||""},bindAnchorForm:function(){var e=this.anchorForm.querySelector("a"),t=this;return this.anchorForm.addEventListener("click",function(e){e.stopPropagation()}),this.anchorInput.addEventListener("keyup",function(e){13===e.keyCode&&(e.preventDefault(),t.createLink(this))}),this.anchorInput.addEventListener("click",function(e){e.stopPropagation(),t.keepToolbarAlive=!0}),this.anchorInput.addEventListener("blur",function(){t.keepToolbarAlive=!1,t.checkSelection()}),e.addEventListener("click",function(e){e.preventDefault(),t.showToolbarActions(),o(t.savedSelection)}),this},hideAnchorPreview:function(){this.anchorPreview.classList.remove("medium-editor-anchor-preview-active")},showAnchorPreview:function(t){if(this.anchorPreview.classList.contains("medium-editor-anchor-preview-active"))return!0;var n,i,o,r=this,a=40,s=t.getBoundingClientRect(),c=(s.left+s.right)/2;return r.anchorPreview.querySelector("i").innerHTML=t.href,n=r.anchorPreview.offsetWidth/2,i=r.options.diffLeft-n,clearTimeout(o),o=setTimeout(function(){r.anchorPreview&&!r.anchorPreview.classList.contains("medium-editor-anchor-preview-active")&&r.anchorPreview.classList.add("medium-editor-anchor-preview-active")
},100),r.observeAnchorPreview(t),r.anchorPreview.classList.add("medium-toolbar-arrow-over"),r.anchorPreview.classList.remove("medium-toolbar-arrow-under"),r.anchorPreview.style.top=Math.round(a+s.bottom-r.options.diffTop+e.pageYOffset-r.anchorPreview.offsetHeight)+"px",r.anchorPreview.style.left=n>c?i+n+"px":e.innerWidth-c<n?e.innerWidth+i-n+"px":i+c+"px",this},observeAnchorPreview:function(e){var t=this,n=(new Date).getTime(),i=!0,o=function(){n=(new Date).getTime(),i=!0},r=function(e){e.relatedTarget&&/anchor-preview/.test(e.relatedTarget.className)||(i=!1)},a=setInterval(function(){if(i)return!0;var s=(new Date).getTime()-n;s>t.options.anchorPreviewHideDelay&&(t.hideAnchorPreview(),clearInterval(a),t.anchorPreview.removeEventListener("mouseover",o),t.anchorPreview.removeEventListener("mouseout",r),e.removeEventListener("mouseover",o),e.removeEventListener("mouseout",r))},200);t.anchorPreview.addEventListener("mouseover",o),t.anchorPreview.addEventListener("mouseout",r),e.addEventListener("mouseover",o),e.addEventListener("mouseout",r)},createAnchorPreview:function(){var e=this,n=t.createElement("div");return n.id="medium-editor-anchor-preview-"+this.id,n.className="medium-editor-anchor-preview",n.innerHTML=this.anchorPreviewTemplate(),t.body.appendChild(n),n.addEventListener("click",function(){e.anchorPreviewClickHandler()}),n},anchorPreviewTemplate:function(){return'<div class="medium-editor-toolbar-anchor-preview" id="medium-editor-toolbar-anchor-preview">    <i class="medium-editor-toolbar-anchor-preview-inner"></i></div>'},anchorPreviewClickHandler:function(){if(this.activeAnchor){var n=this,i=t.createRange(),o=e.getSelection();i.selectNodeContents(n.activeAnchor),o.removeAllRanges(),o.addRange(i),setTimeout(function(){n.activeAnchor&&n.showAnchorForm(n.activeAnchor.href),n.keepToolbarAlive=!1},100+n.options.delay)}this.hideAnchorPreview()},editorAnchorObserver:function(e){var t=this,n=!0,i=function(){n=!1,t.activeAnchor.removeEventListener("mouseout",i)};if(e.target&&"a"===e.target.tagName.toLowerCase()){if(!/href=["']\S+["']/.test(e.target.outerHTML)||/href=["']#\S+["']/.test(e.target.outerHTML))return!0;if(this.toolbar.classList.contains("medium-editor-toolbar-active"))return!0;this.activeAnchor=e.target,this.activeAnchor.addEventListener("mouseout",i),setTimeout(function(){n&&t.showAnchorPreview(e.target)},t.options.delay)}},bindAnchorPreview:function(){var e,t=this;for(this.editorAnchorObserverWrapper=function(e){t.editorAnchorObserver(e)},e=0;e<this.elements.length;e+=1)this.elements[e].addEventListener("mouseover",this.editorAnchorObserverWrapper);return this},checkLinkFormat:function(e){var t=/^https?:\/\//;return e.match(t)?e:"http://"+e},setTargetBlank:function(){var e,t=r();if("a"===t.tagName.toLowerCase())t.target="_blank";else for(t=t.getElementsByTagName("a"),e=0;e<t.length;e+=1)t[e].target="_blank"},createLink:function(e){o(this.savedSelection),this.options.checkLinkFormat&&(e.value=this.checkLinkFormat(e.value)),t.execCommand("createLink",!1,e.value),this.options.targetBlank&&this.setTargetBlank(),this.showToolbarActions(),e.value=""},bindWindowActions:function(){var t,n=this;return this.windowResizeHandler=function(){clearTimeout(t),t=setTimeout(function(){n.toolbar&&n.toolbar.classList.contains("medium-editor-toolbar-active")&&n.setToolbarPosition()},100)},e.addEventListener("resize",this.windowResizeHandler),this},activate:function(){this.isActive||this.setup()},deactivate:function(){var n;if(this.isActive)for(this.isActive=!1,void 0!==this.toolbar&&(t.body.removeChild(this.anchorPreview),t.body.removeChild(this.toolbar),delete this.toolbar,delete this.anchorPreview),t.documentElement.removeEventListener("mouseup",this.checkSelectionWrapper),e.removeEventListener("resize",this.windowResizeHandler),n=0;n<this.elements.length;n+=1)this.elements[n].removeEventListener("mouseover",this.editorAnchorObserverWrapper),this.elements[n].removeEventListener("keyup",this.checkSelectionWrapper),this.elements[n].removeEventListener("blur",this.checkSelectionWrapper),this.elements[n].removeEventListener("paste",this.pasteWrapper),this.elements[n].removeAttribute("contentEditable"),this.elements[n].removeAttribute("data-medium-element")},htmlEntities:function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},bindPaste:function(){var e,n=this;for(this.pasteWrapper=function(e){var i,o,r="";if(this.classList.remove("medium-editor-placeholder"),!n.options.forcePlainText&&!n.options.cleanPastedHTML)return this;if(e.clipboardData&&e.clipboardData.getData&&!e.defaultPrevented){if(e.preventDefault(),n.options.cleanPastedHTML&&e.clipboardData.getData("text/html"))return n.cleanPaste(e.clipboardData.getData("text/html"));if(n.options.disableReturn)t.execCommand("insertHTML",!1,e.clipboardData.getData("text/plain"));else{for(i=e.clipboardData.getData("text/plain").split(/[\r\n]/g),o=0;o<i.length;o+=1)""!==i[o]&&(r+=navigator.userAgent.match(/firefox/i)&&0===o?n.htmlEntities(i[o]):"<p>"+n.htmlEntities(i[o])+"</p>");t.execCommand("insertHTML",!1,r)}}},e=0;e<this.elements.length;e+=1)this.elements[e].addEventListener("paste",this.pasteWrapper);return this},setPlaceholders:function(){var e,t=function(e){""===e.textContent.replace(/^\s+|\s+$/g,"")&&e.classList.add("medium-editor-placeholder")},n=function(e){this.classList.remove("medium-editor-placeholder"),"keypress"!==e.type&&t(this)};for(e=0;e<this.elements.length;e+=1)t(this.elements[e]),this.elements[e].addEventListener("blur",n),this.elements[e].addEventListener("keypress",n);return this},cleanPaste:function(e){var n,i,o,r=this.getSelectionElement(),a=/<p|<br|<div/.test(e),s=[[new RegExp(/<[^>]*docs-internal-guid[^>]*>/gi),""],[new RegExp(/<\/b>(<br[^>]*>)?$/gi),""],[new RegExp(/<span class="Apple-converted-space">\s+<\/span>/g)," "],[new RegExp(/<br class="Apple-interchange-newline">/g),"<br>"],[new RegExp(/<span[^>]*(font-style:italic;font-weight:bold|font-weight:bold;font-style:italic)[^>]*>/gi),'<span class="replace-with italic bold">'],[new RegExp(/<span[^>]*font-style:italic[^>]*>/gi),'<span class="replace-with italic">'],[new RegExp(/<span[^>]*font-weight:bold[^>]*>/gi),'<span class="replace-with bold">'],[new RegExp(/&lt;(\/?)(i|b|a)&gt;/gi),"<$1$2>"],[new RegExp(/&lt;a\s+href=(&quot;|&rdquo;|&ldquo;||)([^&]+)(&quot;|&rdquo;|&ldquo;||)&gt;/gi),'<a href="$2">']];for(n=0;n<s.length;n+=1)e=e.replace(s[n][0],s[n][1]);if(a)for(i=e.split("<br><br>"),this.pasteHTML("<p>"+i.join("</p><p>")+"</p>"),t.execCommand("insertText",!1,"\n"),i=r.querySelectorAll("p,div,br"),n=0;n<i.length;n+=1)switch(o=i[n],o.tagName.toLowerCase()){case"p":case"div":this.filterCommonBlocks(o);break;case"br":this.filterLineBreak(o)}else this.pasteHTML(e)},pasteHTML:function(e){var n,i,o,r,a=t.createDocumentFragment();for(a.appendChild(t.createElement("body")),r=a.querySelector("body"),r.innerHTML=e,this.cleanupSpans(r),n=r.querySelectorAll("*"),o=0;o<n.length;o+=1)i=n[o],i.removeAttribute("class"),i.removeAttribute("style"),i.removeAttribute("dir"),"meta"===i.tagName.toLowerCase()&&i.parentNode.removeChild(i);t.execCommand("insertHTML",!1,r.innerHTML.replace(/&nbsp;/g," "))},isCommonBlock:function(e){return e&&("p"===e.tagName.toLowerCase()||"div"===e.tagName.toLowerCase())},filterCommonBlocks:function(e){/^\s*$/.test(e.innerText)&&e.parentNode.removeChild(e)},filterLineBreak:function(e){this.isCommonBlock(e.previousElementSibling)?e.parentNode.removeChild(e):!this.isCommonBlock(e.parentNode)||e.parentNode.firstChild!==e&&e.parentNode.lastChild!==e?1===e.parentNode.childElementCount&&this.removeWithParent(e):e.parentNode.removeChild(e)},removeWithParent:function(e){e&&e.parentNode&&(e.parentNode.parentNode&&1===e.parentNode.childElementCount?e.parentNode.parentNode.removeChild(e.parentNode):e.parentNode.removeChild(e.parentNode))},cleanupSpans:function(e){var n,i,o,r=e.querySelectorAll(".replace-with");for(n=0;n<r.length;n+=1)i=r[n],o=t.createElement(i.classList.contains("bold")?"b":"i"),o.innerHTML=i.classList.contains("bold")&&i.classList.contains("italic")?"<i>"+i.innerHTML+"</i>":i.innerHTML,i.parentNode.replaceChild(o,i);for(r=e.querySelectorAll("span"),n=0;n<r.length;n+=1)i=r[n],/^\s*$/.test()?i.parentNode.removeChild(i):i.parentNode.replaceChild(t.createTextNode(i.innerText),i)}}}(window,document);